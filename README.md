
# A304Data åŒ…

## å®‰è£…

æ¨èä½¿ç”¨å¼€å‘æ¨¡å¼å®‰è£…ï¼Œè¿™æ ·å¯ä»¥åœ¨æœ¬åœ°ä¿®æ”¹ä»£ç åç«‹å³ç”Ÿæ•ˆï¼š

```bash
# å…‹éš†ä»“åº“
git clone git@github.com:Enderwitherzjdl/a304data.git
cd a304data

# å®‰è£…åŒ…ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
pip install -e .
```


## å·¥å…·1ï¼šPPLoopDataset æ•°æ®å¤„ç†å·¥å…·ï¼ˆè¿˜æ²¡æ›´æ–°ï¼‰

æœ¬å·¥å…·ç”¨äºå¤„ç†æ³µæµ¦-æ¢æµ‹ï¼ˆPump-Probe, PPï¼‰å®éªŒä¸­å¤šåœˆé‡å¤æµ‹é‡æ•°æ®ï¼ˆloop dataï¼‰ï¼Œæä¾›ï¼š
- **å•åœˆæ•°æ®è¯»å–**
- **å¹³å‡å€¼è®¡ç®—**
- **å¹³å‡æ•°æ®è‡ªåŠ¨å­˜å‚¨ä¸è‡ªåŠ¨åŠ è½½**
- **å»¶æ—¶/æ³¢é•¿æ–¹å‘å¿«é€Ÿç»˜å›¾**
- **åç‚¹è·³ç‚¹æ¸…æ´—**

é€‚ç”¨äº A304 ä¸­æµ‹è¯•ç”µè„‘çš„ LabVIEW ç¨‹åºä¿å­˜çš„æ•°æ®æ ¼å¼ï¼ˆå¦‚ `yymmdd_hhmmss_loop{num}.dat` ä¸ç³»ç»Ÿç”Ÿæˆçš„ `yymmdd_hhmmss_averaged.dat`ï¼‰ï¼Œä¹Ÿæ”¯æŒæœ¬ç¨‹åºåŒ…ä¿å­˜çš„å¹³å‡æ•°æ®ã€‚

---

### ğŸ”§ åŸºæœ¬ä½¿ç”¨æµç¨‹

```python
from a304data import PPLoopDataset

ds = PPLoopDataset(folder='.', wl_min=450, wl_max=750)
````

è¯·ä¿è¯ç›®å½•ä¸‹æœ‰ä¸”ä»…æœ‰**ä¸€å¥—æ•°æ®**ï¼Œå…¶ä¸­åŒ…å«**è‹¥å¹²åœˆçš„åŸå§‹æ•°æ®**ä»¥åŠ**ä¸è¶…è¿‡ä¸€ä¸ªè‡ªåŠ¨ä¿å­˜çš„å¹³å‡å€¼æ•°æ®**ã€‚

åˆå§‹åŒ–å®Œæˆåä¼šè‡ªåŠ¨ï¼š

* è¯»å–æ‰€æœ‰ `yymmdd_hhmmss_loop{num}.dat` æ•°æ®ä½œä¸ºåŸå§‹æ•°æ®
* æ£€æŸ¥æ˜¯å¦å­˜åœ¨ `saved_averaged.dat` æˆ–åŸå§‹ LabVIEW å¹³å‡ç»“æœ
* è‹¥å­˜åœ¨å·²ä¿å­˜å¹³å‡å€¼ï¼Œåˆ™è‡ªåŠ¨è½½å…¥ï¼Œå¹¶è¯»å– `saved_info.dat` ä¸­çš„å¹³å‡ä¿¡æ¯

---

### ğŸ“ æ–‡ä»¶ç»“æ„è¯´æ˜

| æ–‡ä»¶                          | å«ä¹‰                                                   |
| ----------------------------- | ------------------------------------------------------ |
| `yymmdd_hhmmss_loop{num}.dat` | å•åœˆæ•°æ®æ–‡ä»¶ï¼ˆæ¯æ¬¡æ‰«æä¸€åœˆï¼‰                           |
| `saved_averaged.dat`          | **ä½ æ‰‹åŠ¨ä¿å­˜çš„å¹³å‡æ•°æ®**                               |
| `saved_info.dat`              | ä¿å­˜å¹³å‡ä½¿ç”¨çš„ loop ä¿¡æ¯ï¼ˆjson æ ¼å¼ï¼‰                  |
| `yymmdd_hhmmss_averaged.dat`  | LabVIEW è‡ªåŠ¨ç”Ÿæˆçš„å¹³å‡æ•°æ®ï¼ˆè‹¥å­˜åœ¨ä¸”å”¯ä¸€ï¼Œä¼šè‡ªåŠ¨è¯†åˆ«ï¼‰ |

---

### ğŸ“Š å¯è§†åŒ–æ–¹æ³•

#### 1. æŒ‰å»¶æ—¶ç»˜å›¾

```python
ds.plot_at_delay(2.5, [1, 3, 'avg'])   # ç”»ç¬¬1åœˆã€ç¬¬3åœˆ å’Œå¹³å‡æ›²çº¿
ds.plot_at_delay(2.5, 'avg')           # ä»…ç”»å¹³å‡
ds.plot_at_delay(2.5, range(1,5))      # ç”»1~4åœˆ
```

#### 2. æŒ‰æ³¢é•¿ç»˜å›¾

```python
ds.plot_at_wavelength(600, ['avg'])
ds.plot_at_wavelength(600, [1, 2, 5])
```

---

### ğŸ§® è®¡ç®—å¹¶ä¿å­˜å¹³å‡æ•°æ®

#### è®¡ç®—å¹³å‡

```python
ds.calculate_averaged_data(4)     # å–å‰4åœˆå¹³å‡
ds.calculate_averaged_data([1,3,5])  # è‡ªå®šä¹‰åœˆç¼–å·
```

#### ä¿å­˜æ•°æ®

```python
ds.save_averaged_data()
```

ç”Ÿæˆæ–‡ä»¶ï¼š

```
saved_averaged.dat   # å¹³å‡ç»“æœ
saved_info.dat       # åŒ…å« averaged_loop_num å’Œ averaged_loops
```

---

### ğŸ©º æ•°æ®æ¸…æ´—

ç”¨äºä¿®å¤éƒ¨åˆ†æ‰«æå—è§¦å‘é”™è¯¯å¯¼è‡´çš„è·³ç‚¹ï¼š

```python
ds.clean_jump_points(ref_wl=500, threshold=0.02)
```

* `ref_wl`: åˆ¤æ–­åç‚¹çš„å‚è€ƒæ³¢é•¿
* `threshold`: è·³ç‚¹åˆ¤æ–­é˜ˆå€¼ï¼ˆé»˜è®¤0.02ï¼‰

---

### âš™ï¸ ç±»ç»“æ„å‚è€ƒ

```python
class PPLoopDataset:
    _load_original_data()     # åŠ è½½ loop åŸå§‹æ•°æ®
    _load_averaged_data()     # è‡ªåŠ¨è¯†åˆ«å¹¶åŠ è½½å¹³å‡æ•°æ®
    calculate_averaged_data() # æ ¹æ®è¾“å…¥åœˆæ•°è®¡ç®—å¹³å‡
    save_averaged_data()      # ä¿å­˜å¹³å‡æ•°æ® + ä¿¡æ¯
    plot_at_delay()           # å»¶æ—¶æ–¹å‘ç»˜å›¾
    plot_at_wavelength()      # æ³¢é•¿æ–¹å‘ç»˜å›¾
    clean_jump_points()       # æ¸…é™¤æµ‹è¯•åç‚¹
```

---

### ğŸ“Œ å¤‡æ³¨

* æœ¬å·¥å…·é»˜è®¤å‡è®¾æ‰€æœ‰ loop æ•°æ®å…·æœ‰ç›¸åŒçš„å»¶æ—¶ç‚¹å’Œæ³¢é•¿ç‚¹åˆ†å¸ƒ
* å¹³å‡æ•°æ®ä¼šè‡ªåŠ¨ä¸åŸå§‹æ•°æ®å¯¹é½
* ä¼˜å…ˆä½¿ç”¨ `saved_averaged.dat`ï¼Œä»…å½“ä¸å­˜åœ¨æ—¶æ‰ä¼šè¯»å– LabVIEW è‡ªå¸¦ averaged æ–‡ä»¶



## å·¥å…·2ï¼šUVVisDataset æ•°æ®å¤„ç†å·¥å…·

æœ¬å·¥å…·ç”¨äºå¤„ç†æ³µæµ¦-æ¢æµ‹ï¼ˆPump-Probe, PPï¼‰å®éªŒä¸­å¤šåœˆé‡å¤æµ‹é‡æ•°æ®ï¼ˆloop dataï¼‰ï¼Œæä¾›ï¼š

- **UVVisæ•°æ®è¯»å–**
- **å¸å…‰åº¦è®¡ç®—**
- **å¯»å³°**
- **ç»˜å›¾å¹¶æ ‡å³°**

é€‚ç”¨äºå®éªŒå®¤ä¸­å¸¸è§çš„ LabVIEW è¾“å‡ºæ ¼å¼ï¼ˆå¦‚ `*_loop.dat` ä¸ç³»ç»Ÿç”Ÿæˆçš„ `averaged.dat`ï¼‰ï¼Œä¹Ÿæ”¯æŒè‡ªè¡Œä¿å­˜çš„å¹³å‡æ•°æ®ã€‚

---

### ğŸ”§ åŸºæœ¬ä½¿ç”¨æµç¨‹

```python
from a304data import UVVisDataset

DLamp = UVVisDataset('DLamp')
DLamp.calculate_absorbance()
DLamp.find_peak(height=0.6, prominence=0.1)
DLamp.plot_uvvis()
```

ç¨‹åºåªä¼šè¯»å…¥æ–‡ä»¶ååŒ…å« `FX2000_FX2K243001` çš„æ•°æ®æ–‡ä»¶ã€‚å…¶ä¸­å‘½ååŒ…å«äº†`bg`æˆ–`background`çš„å°†è¢«è§†ä¸ºèƒŒæ™¯æ–‡ä»¶ï¼Œå…¶ä»–æ–‡ä»¶è§†ä¸ºå…‰è°±æ–‡ä»¶ã€‚è¯·ä¿è¯ä¸€ä¸ªç›®å½•ä¸‹**æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªèƒŒæ™¯æ–‡ä»¶**ï¼Œä»¥åŠ**è‹¥å¹²å…‰è°±æ–‡ä»¶**ã€‚

